let albums = [
    {
        title: 'It All Began with Loneliness',
        artist: 'The Anchoret',
        year: '2023',
        cover: 'images/albums/anchoret.jpg',
        review: "What made me like this album is the seamless blend of flutes, saxophone, with the heavy and melodic guitar riffs. Additionally, the transitions between heavy and soft are perfectly blended to give space and let the music breathe. What I don't like about this album is that the tones are a little bit repetitive, but the variety of instruments and the overall production of the album makes up for it.",
        score: '4',
        sample: '<iframe  width="100%" height="100%" src="https://www.youtube.com/embed/g8XhYYEPlz4?si=Kle4ymNnDN91Aq9s" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        links: {
            website: 'https://www.theanchoret.com/',
            bandcamp: 'https://theanchoretofficial.bandcamp.com/album/it-all-began-with-loneliness',
            spotify: 'https://open.spotify.com/album/4Wbzq8JDJIY6g1CQI3cDrC',
            apple: 'https://music.apple.com/us/album/it-all-began-with-loneliness/1677582161',
            youtube: 'https://www.youtube.com/playlist?list=OLAK5uy_mKOWQx76BizCgsBIsVPacsaejE3VXiFmk',
        }
    },
    {
        title: 'Would You Miss It',
        artist: 'Koyo',
        year: '2023',
        cover: 'images/albums/koyo.jpg',
        review: "This album is the first that I've heard from the band. Considering that it is their debut album, it is a strong opener to their discography. The melodic hardcore riffs pleasantly scratches my Emo itch. I was hooked by the album cover, and upon first listen, I was not disappointed. The album is a great listen, great flow of music, but it is too short.",
        score: '4',
        sample: '<iframe width="100%" height="100%" src="https://www.youtube.com/embed/zvLnlCtH7Yo?si=Z9H00XWXprT5M6g1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        links: {
            website: 'https://koyolihc.com/',
            bandcamp: 'https://koyolihc.bandcamp.com/album/would-you-miss-it',
            spotify: 'https://open.spotify.com/album/15At5fBHrNsaLtWA7dNWIA',
            apple: 'https://music.apple.com/us/album/would-you-miss-it/1685744995',
            youtube: 'https://www.youtube.com/playlist?list=OLAK5uy_laP6S4PYaYNvk0J5jXS15tuV6XLMLmjeg',
        }
    },
    {
        title: 'Skinwalker Social Club',
        artist: 'MOSSBACK',
        year: '2023',
        cover: 'images/albums/mossback.jpg',
        review: "This is the first album released by MOSSBACK, and with the quality of music that they produce in GRIM SALVO, I had high expectations when I started listening to this album and well... it definitely exceeded my expectations and I listen to it regularly. It definitely has the same vibes as the ones that they did with GRIM SALVO but the prominence of acoustic guitar and otherworldly ambiance of this album makes it different from their duo work.",
        score: '4',
        sample: '<iframe width="100%" height="100%" src="https://www.youtube.com/embed/G_04YWms1PU?si=LMZLDsan0MaUK4B0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        links: {
            // website: 'https://koyolihc.com/',
            bandcamp: 'https://mossback33.bandcamp.com/album/skinwalker-social-club',
            spotify: 'https://open.spotify.com/album/7BRGKpnbl43wFOxFCFVZfX',
            apple: 'https://music.apple.com/us/album/skinwalker-social-club/1710860134',
            youtube: 'https://www.youtube.com/playlist?list=OLAK5uy_l1mZOR6JPrQ7rWfR-vQdsuahy93pJxCzo',
        }
    },
    {
        title: 'Divine Inner Tension',
        artist: 'Hail The Sun',
        year: '2023',
        cover: 'images/albums/hailthesun.jpg',
        review: "This is the latest album from their discography and in my opinion, their best album to date. The singing is outright phenomenal and the lyrical themes are very relatable. The choruses are catchy and sing-a-long-able. The album's flow and transitions are seamless. Towards the end, the album slows down and has an unexpected ending compared to their other albums.",
        score: '4',
        sample: '<iframe width="100%" height="100%" src="https://www.youtube.com/embed/YLexasbqt6A?si=9AdvXAUvYMGSfT27" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        links: {
            website: 'https://hailthesun.com/',
            bandcamp: 'https://hailthesun.bandcamp.com/album/divine-inner-tension',
            spotify: 'https://open.spotify.com/album/0FPyjINPmP3PgiQf1tHmRk',
            apple: 'https://music.apple.com/us/album/divine-inner-tension/1684556095',
            youtube: 'https://www.youtube.com/playlist?list=OLAK5uy_nVUUJRcRDAVCPB-I_r0aqoEQCeAeGqss0',
        }
    },
    {
        title: 'Take Me Back To Eden',
        artist: 'Sleep Token',
        year: '2023',
        cover: 'images/albums/sleeptoken.jpg',
        review: "Upon the drop of the first single, 'Chokehold', I knew that this album would top my list in 2023. The album is full of heavy sections, and genre bending compositions from rap, heavy metal, black metal, and even funk. A great album and a must listen from start to finish.",
        score: '5',
        sample: '<iframe width="100%" height="100%" src="https://www.youtube.com/embed/-UUSUrr6zyo?si=AgpQFXfD9a_h3t0t" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        links: {
            website: 'http://www.sleep-token.com/',
            // bandcamp: 'https://hailthesun.bandcamp.com/album/divine-inner-tension',
            spotify: 'https://open.spotify.com/album/1gjugH97doz3HktiEjx2vY',
            apple: 'https://music.apple.com/us/album/take-me-back-to-eden/1669567703',
            youtube: 'https://www.youtube.com/playlist?list=OLAK5uy_kR2XaVymdtE2e0WXdnqYIViBNemh6_wT4',
        }
    },
    {
        title: 'Cool World',
        artist: 'Chat Pile',
        year: '2024',
        cover: 'images/albums/chatpile.jpg',
        review: "Chat Pile's music embodies raw and unfiltered emotions people. The album has heavy grooves with spoken poetry lyrical delivery. What I like about this album is the textural rawness of the lyrical delivery accompanied with the heavy and groovy basslines that are accented with haunting guitars. While the album is a great listen, some of the songs seems, specifically in the middle of the album, like it is just added to fill the album.",
        score: '4',
        sample: '<iframe width="100%" height="100%" src="https://www.youtube.com/embed/h8YoyzosPDw?si=pEGL8XSYuAb7p1A-" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        links: {
            website: 'https://chatpile.net/',
            bandcamp: 'https://chatpile.bandcamp.com/album/cool-world',
            spotify: 'https://open.spotify.com/album/3k7GhMNdQ0KXGkC84qVRf2',
            apple: 'https://music.apple.com/us/album/cool-world/1750294553',
            youtube: 'https://www.youtube.com/playlist?list=OLAK5uy_lVbCplKuIzME9ocBvaidVo5atObFnWadM',
        }
    },
    {
        title: 'Mark of the Worm',
        artist: 'Landsraad',
        year: '2023',
        cover: 'images/albums/landsraad.jpg',
        review: "I've stumbled upon this album since it piqued me with the album art and the thematic of the album title (as a Dune fan). The music has the atmosphere, anticipation, and flow that captures the essence of the books it is based of. The intro track is a portal to the world of Dune through droning music. If you like ambient music, this album is a must listen.",
        score: '4',
        sample: '<iframe width="560" height="315" src="https://www.youtube.com/embed/WdJ8lMh0r3g?si=nX8JE4ku2wJCtq99" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        links: {
            // website: 'https://chatpile.net/',
            bandcamp: 'https://landsraad.bandcamp.com/album/mark-of-the-worm',
            spotify: 'https://open.spotify.com/album/54ZL1PKkOwvE4BBhoAeonv',
            apple: 'https://music.apple.com/us/album/mark-of-the-worm/1723196132',
            youtube: 'https://www.youtube.com/watch?v=WdJ8lMh0r3g',
        }
    },
    {
        title: 'Maybe in Another Life',
        artist: 'Bloom',
        year: '2024',
        cover: 'images/albums/bloom.jpg',
        review: "A recent addition to my usual album rotation. It has heavy hitting riffs, memorable chrouses, and emotional lyrical delivery. The album has some kind of nostalgic feel to it from the early 2010s emo from moments of angst, to moments of relief. The album is short, but it would beckon you to replay it again and again.",
        score: '4',
        sample: '<iframe width="100%" height="100%" src="https://www.youtube.com/embed/I7urUOVgM_4?si=L5ZmDcJYho-QMFR6" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        links: {
            website: 'https://www.bloomsyd.com/',
            bandcamp: 'https://purenoise.bandcamp.com/album/maybe-in-another-life',
            spotify: 'https://open.spotify.com/album/3VSUMjz2mL2kIrlLek00PL',
            apple: 'https://music.apple.com/us/album/maybe-in-another-life/1712520706',
            youtube: 'https://www.youtube.com/playlist?list=OLAK5uy_nU2C-mZz8lvmsWs2nLfvrfop23C26_nWM',
        }
    },
    {
        title: 'Blue Hour',
        artist: 'Real Friends',
        year: '2024',
        cover: 'images/albums/realfriends.jpg',
        review: "Most recent album from Real Friends with their new vocalist. I haven't listened to them before this album. The album contains the pop punk energy but with feels and emotions of midwest emo. The haunting solo voice in the intro song hooked me due to its rawness and emotion. The album is a great listen and has dynamic tonality of songs.",
        score: '4',
        sample: '<iframe width="100%" height="100%" src="https://www.youtube.com/embed/zjmayULQGds?si=AXlrBXgjVYdrV8B6" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        links: {
            website: 'https://www.realfriends.band/',
            bandcamp: 'https://realfriends.bandcamp.com/album/blue-hour',
            spotify: 'https://open.spotify.com/album/1PEGf8YJnr7wSxkISJvkvf',
            apple: 'https://music.apple.com/us/album/blue-hour/1756192327',
            youtube: 'https://www.youtube.com/playlist?list=OLAK5uy_neCOGm9xy2PGeSla3-lfZNs5Q-G_Hk0zg',
        }
    },
    {
        title: 'You Won\'t Go Before You\'re Supposed To',
        artist: 'Knocked Loose',
        year: '2024',
        cover: 'images/albums/knockedloose.jpg',
        review: "If you haven't heard Knocked Loose, and you want to be <i>knocked loose</i>, then listen to this record, and you will be knocked loose. This heavy htting album would have at the edge of your seat. It also features artists such as Poppy and Chris Motionless. If you feel like punching a wall, this album would do the trick.",
        score: '5',
        sample: '<iframe width="100%" height="100%" src="https://www.youtube.com/embed/RAuuVY__KQ0?si=cSNlJbEpuklqwH8K" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        links: {
            // website: 'https://www.realfriends.band/',
            bandcamp: 'https://knockedloose.bandcamp.com/album/you-wont-go-before-youre-supposed-to',
            spotify: 'https://open.spotify.com/album/2sLBMdUF5HYNB0voqWs4K3',
            apple: 'https://music.apple.com/us/album/you-wont-go-before-youre-supposed-to/1732119298',
            youtube: 'https://www.youtube.com/playlist?list=PLYQhPJrQIlgNIbK4FWGZHU_z03aX6jkcK',
        }
    },
    {
        title: 'Die Urkatastrophe',
        artist: 'Kanonenfieber',
        year: '2024',
        cover: 'images/albums/kanonenfieber.png',
        review: "A monumental release from the German band Kanonenfieber that recounts events and stories from the first world war. From the piercing vocals, to atmospheric soundscapes that makes you feel like you are in a war, the music and power from the instrumtents are top-notch. The album is a mix of black metal, death metal, and symphonic. The album is a must listen for fans of history and metal.",
        score: '4',
        sample: '<iframe width="100%" height="100%" src="https://www.youtube.com/embed/7f8N0UQAZF0?si=6aOD5YvF6yCLqzxa" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>',
        links: {
            website: 'https://noisebringer.de/index.php/de/projekte/kanonenfieber',
            bandcamp: 'https://noisebringer-records.bandcamp.com/album/die-urkatastrophe-2',
            spotify: 'https://open.spotify.com/album/15cBVOLGxioRUCDrkcLiAr',
            apple: 'https://music.apple.com/us/album/die-urkatastrophe/1749071999',
            youtube: 'https://www.youtube.com/playlist?list=OLAK5uy_mXYKlLPeYSic0m37K06uZwcvtDETJbJcE',
        }
    },
]

function createAlbumCards(year) {
    let list = albums.filter(a => a.year == year);
    let container = document.getElementById(`${year}-list`)
    container.innerHTML = `${list.map(a => createCard(a)).join('')}`;
}

function showDropdown() {
    let dropdown = document.getElementById('top-menu');
    dropdown.classList.add('active');
}

function hideDropdown() {
    let dropdown = document.getElementById('top-menu');
    dropdown.classList.remove('active');
}

function createCard(album) {
    return `
    <li class="card" tabindex="0">
        <div class="content items">
            <div class="card-top item">
                <div class="card-image image">
                    <img src="${album.cover}" alt="${album.title} Album Cover">
                </div>
                <div class="content">
                    <div><div class="ui rating" data-rating="${album.score}" data-max-rating="5"> </div></div>
                    <div class="album-title"><span>${album.title}</span> <span>(${album.year})</span></div>
                    <div class="album-artist"><span>${album.artist}</span></div>
                </div>
            </div>
        </div>
        <div class="content"><p>${album.review}</p></div>
        <div class="content">
            <details class="ui card-links-con" > 
                <summary style="cursor: pointer;" title="Show Links">Links</summary>
                <div class="menu text card-links">
                    ${Object.keys(album.links).map(a => `<a href="${album.links[a]}" target="_blank" class="item" title="${a} link">${a} <i class="ui icon ${a == 'website' ? 'linkify' : a}"></i></a>`).join('')}
                    ${album.sample ? ` <a data-album="${album.title}" href="#" onclick="openPopover(event, this);" target="_blank" class="item" title="sample"><i class="icon music"></i></a>` : ''}
                </div>
            </details>
        </div>
    </li>
    `
}

function openPopover(event, element) {
    event.preventDefault();
    let popover = document.getElementById('sampleMusicPopover');
    let con = document.getElementById('sampleMusicCon');
    popover.showModal();
    con.innerHTML = albums.find(a => a.title == element.dataset.album).sample;
}

function checkBreakpoint() {
    // Check if the screen is less than 768px

    // Get the navigation element
    let navigation = document.getElementById('navigation');
    // Get the dropdown element
    let dropdown = navigation.querySelector('#top-menu');
    // Get the icon element
    let icon = dropdown.querySelector('i');
    // Get the heading element
    let nav_heading = navigation.querySelector('.header.item');
    // Get the menu element
    let menu = dropdown.querySelector('.menu');
    if (window.innerWidth >= 768) {
        // Set dropdown styles and classes
        dropdown.style.position = 'static';
        dropdown.style.width = 'fit-content';
        dropdown.classList.remove('floating', 'dropdown');
        dropdown.classList.add('text', 'menu')
        // Set heading styles
        nav_heading.style.margin = '0';
        // Set icon styles
        icon.style.display = 'none';
        // Set menu styles
        menu.classList.add('text')
        menu.style.gap = '1em';
        menu.querySelectorAll('.item').forEach((a) => {
            a.style.width = 'fit-content';
        });
    } else {
        // Revert dropdown styles and classes
        dropdown.style.position = 'absolute';
        dropdown.classList.add('floating', 'dropdown');
        dropdown.classList.remove('text', 'menu')
        // Revert heading styles
        nav_heading.style.margin = '0 auto';
        // Revert icon styles
        icon.style.display = '';
        // Revert menu styles
        menu.classList.remove('text')
        menu.style.gap = '0';
        menu.querySelectorAll('li').forEach((a) => {
            a.style.width = 'inherit';
        });
    }
}


function init() {
    // Get the menu element
    let menu = document.querySelector('ul.menu');
    // Add event listener to the menu anchors
    menu.querySelectorAll('a').forEach(a => a.addEventListener('click', (e) => {
        if (e.currentTarget.id == "darkModeBtn") return
        // Remove the active class from anchors with active class
        e.target.parentElement.parentElement.querySelectorAll('a.active').forEach(a => a.classList.remove('active'));
        // Add the active class to the clicked anchor
        e.target.classList.add('active');
    }));
    // Add event listener to the window resize event
    window.addEventListener('resize', checkBreakpoint);
    // Call the checkBreakpoint function
    checkBreakpoint()
    // Set Darkmode
    DarkReader.setFetchMethod(window.fetch);
    window.isDarkMode = localStorage.getItem('isDarkMode');
    if (isDarkMode == 'true') {
        DarkReader.enable();
        darkModeBtn.innerHTML = '<i class="sun icon"></i>';
    } else {
        DarkReader.disable();
        darkModeBtn.innerHTML = '<i class="moon icon"></i>';
    }
    createAlbumCards("2024")
    createAlbumCards("2023")
    $('.ui.rating')
        .rating('disable')
        ;
}

function toggleDarkMode() {
    isDarkMode = !JSON.parse(isDarkMode);
    if (isDarkMode) {
        DarkReader.enable();
        darkModeBtn.innerHTML = '<i class="sun icon"></i>';
    } else {
        DarkReader.disable();
        darkModeBtn.innerHTML = '<i class="moon icon"></i>';
    }
    localStorage.setItem('isDarkMode', isDarkMode); // Save theme preference
}

